<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîß Resetear Datos del Sistema</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        .reset-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 600px;
        }
    </style>
</head>
<body>
    <div class="reset-card">
        <h1 class="text-center mb-4">
            <i class="bi bi-arrow-clockwise text-warning"></i>
            Resetear Sistema
        </h1>
        
        <div class="alert alert-warning">
            <i class="bi bi-exclamation-triangle"></i>
            <strong>¬°Atenci√≥n!</strong> Esta acci√≥n eliminar√° todos los datos del sistema y los recrear√° correctamente.
        </div>

        <div class="alert alert-info">
            <h6><i class="bi bi-info-circle"></i> Se crear√°n:</h6>
            <ul class="mb-0">
                <li><strong>Administrador:</strong> admin@comunes.cl (con casa 8651-A)</li>
                <li><strong>Residentes:</strong> 4 usuarios de prueba</li>
                <li><strong>Gastos:</strong> 6 gastos comunes</li>
                <li><strong>Pagos:</strong> 2 pagos de ejemplo</li>
            </ul>
        </div>

        <div class="d-grid gap-3">
            <button class="btn btn-danger btn-lg" onclick="resetearYCrearDatos()">
                <i class="bi bi-arrow-clockwise"></i> RESETEAR Y CREAR DATOS CORRECTOS
            </button>
            <a href="diagnostico.html" class="btn btn-secondary">
                <i class="bi bi-arrow-left"></i> Volver al Diagn√≥stico
            </a>
            <a href="login.html" class="btn btn-success">
                <i class="bi bi-box-arrow-in-right"></i> Ir al Login
            </a>
        </div>

        <div id="resultado" class="mt-4"></div>
    </div>

    <script src="js/script.js"></script>
    <script>
        function resetearYCrearDatos() {
            const resultado = document.getElementById('resultado');
            resultado.innerHTML = '<div class="alert alert-info"><i class="spinner-border spinner-border-sm me-2"></i>Reseteando sistema...</div>';

            // PASO 1: Limpiar TODO
            localStorage.clear();
            console.log('‚úÖ LocalStorage limpiado');

            // PASO 2: Crear usuarios CORRECTOS
            const usuarios = [
                {
                    email: 'admin@comunes.cl',
                    password: 'Admin123!',
                    nombre: 'Administrador Principal',
                    rut: '12.345.678-9',
                    telefono: '987654321',
                    pasaje: '8651',
                    casa: 'A',
                    rol: 'administrador',  // ‚Üê ESTO ES CR√çTICO
                    tipo: 'administrador',  // ‚Üê Y ESTO TAMBI√âN
                    fechaRegistro: new Date().toISOString()
                },
                {
                    email: 'usuario@comunes.cl',
                    password: 'User123!',
                    nombre: 'Juan P√©rez Soto',
                    rut: '98.765.432-1',
                    telefono: '912345678',
                    pasaje: '8651',
                    casa: 'B',
                    rol: 'residente',
                    tipo: 'residente',
                    fechaRegistro: new Date().toISOString()
                },
                {
                    email: 'maria@comunes.cl',
                    password: 'Maria123!',
                    nombre: 'Mar√≠a Gonz√°lez L√≥pez',
                    rut: '11.222.333-4',
                    telefono: '923456789',
                    pasaje: '8651',
                    casa: 'C',
                    rol: 'residente',
                    tipo: 'residente',
                    fechaRegistro: new Date().toISOString()
                },
                {
                    email: 'pedro@comunes.cl',
                    password: 'Pedro123!',
                    nombre: 'Pedro Ram√≠rez Castro',
                    rut: '22.333.444-5',
                    telefono: '934567890',
                    pasaje: '8707',
                    casa: 'A',
                    rol: 'residente',
                    tipo: 'residente',
                    fechaRegistro: new Date().toISOString()
                },
                {
                    email: 'ana@comunes.cl',
                    password: 'Ana123!',
                    nombre: 'Ana Mart√≠nez Silva',
                    rut: '33.444.555-6',
                    telefono: '945678901',
                    pasaje: '8707',
                    casa: 'B',
                    rol: 'residente',
                    tipo: 'residente',
                    fechaRegistro: new Date().toISOString()
                }
            ];

            localStorage.setItem('usuarios', JSON.stringify(usuarios));
            console.log('‚úÖ Usuarios creados:', usuarios.length);

            // PASO 3: Crear gastos
            const gastos = [
                {
                    id: 1,
                    concepto: 'Mantenci√≥n de √Åreas Verdes',
                    categoria: 'Jardiner√≠a',
                    monto: 65000,
                    fecha: '2025-11-01',
                    descripcion: 'Poda y mantenci√≥n mensual de jardines',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                },
                {
                    id: 2,
                    concepto: 'Luz de √Åreas Comunes',
                    categoria: 'Servicios B√°sicos',
                    monto: 48000,
                    fecha: '2025-11-01',
                    descripcion: 'Consumo el√©ctrico',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                },
                {
                    id: 3,
                    concepto: 'Agua Potable',
                    categoria: 'Servicios B√°sicos',
                    monto: 32000,
                    fecha: '2025-11-01',
                    descripcion: 'Consumo de agua',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                },
                {
                    id: 4,
                    concepto: 'Seguridad',
                    categoria: 'Seguridad',
                    monto: 120000,
                    fecha: '2025-11-01',
                    descripcion: 'Vigilancia nocturna',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                },
                {
                    id: 5,
                    concepto: 'Limpieza',
                    categoria: 'Limpieza',
                    monto: 75000,
                    fecha: '2025-11-01',
                    descripcion: 'Aseo de √°reas comunes',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                },
                {
                    id: 6,
                    concepto: 'Gas Com√∫n',
                    categoria: 'Servicios B√°sicos',
                    monto: 28000,
                    fecha: '2025-11-01',
                    descripcion: 'Consumo de gas',
                    estado: 'aprobado',
                    fechaCreacion: new Date().toISOString()
                }
            ];

            localStorage.setItem('gastos', JSON.stringify(gastos));
            console.log('‚úÖ Gastos creados:', gastos.length);

            // PASO 4: Crear pagos de ejemplo
            const pagos = [
                {
                    id: 1,
                    email: 'maria@comunes.cl',
                    pasaje: '8651',
                    casa: 'C',
                    monto: 28308,
                    mes: '2025-10',
                    fechaPago: '2025-10-15T14:30:00',
                    metodoPago: 'transferencia',
                    comprobante: 'TRF-20251015-001',
                    estado: 'confirmado',
                    registradoPor: 'admin@comunes.cl'
                },
                {
                    id: 2,
                    email: 'pedro@comunes.cl',
                    pasaje: '8707',
                    casa: 'A',
                    monto: 28308,
                    mes: '2025-10',
                    fechaPago: '2025-10-20T10:15:00',
                    metodoPago: 'efectivo',
                    comprobante: 'EFE-20251020-001',
                    estado: 'confirmado',
                    registradoPor: 'admin@comunes.cl'
                }
            ];

            localStorage.setItem('pagos', JSON.stringify(pagos));
            console.log('‚úÖ Pagos creados:', pagos.length);

            // MOSTRAR RESULTADO
            resultado.innerHTML = `
                <div class="alert alert-success">
                    <h5><i class="bi bi-check-circle"></i> ¬°Sistema Reseteado Correctamente!</h5>
                    <hr>
                    <p><strong>Se crearon:</strong></p>
                    <ul>
                        <li>‚úÖ ${usuarios.length} usuarios (1 admin + 4 residentes)</li>
                        <li>‚úÖ ${gastos.length} gastos comunes</li>
                        <li>‚úÖ ${pagos.length} pagos de ejemplo</li>
                    </ul>
                    <hr>
                    <p class="mb-0"><strong>Credenciales de Admin:</strong></p>
                    <div class="code-block bg-dark text-light p-3 rounded mt-2">
                        <strong>Email:</strong> admin@comunes.cl<br>
                        <strong>Password:</strong> Admin123!<br>
                        <strong>Casa:</strong> 8651-A<br>
                        <strong>Rol:</strong> administrador ‚úÖ
                    </div>
                </div>
                <div class="d-grid gap-2 mt-3">
                    <a href="diagnostico.html" class="btn btn-info">
                        <i class="bi bi-clipboard-check"></i> Verificar en Diagn√≥stico
                    </a>
                    <a href="login.html" class="btn btn-success">
                        <i class="bi bi-box-arrow-in-right"></i> Ir al Login
                    </a>
                </div>
            `;

            console.log('========================================');
            console.log('‚úÖ SISTEMA RESETEADO CORRECTAMENTE');
            console.log('========================================');
            console.log('Usuarios:', usuarios);
            console.log('Gastos:', gastos);
            console.log('Pagos:', pagos);
        }
    </script>
</body>
</html>
